# cloud/frontend/nginx.conf
server {
    # Listen on the port Fly.io expects
    listen 0.0.0.0:8080;

    # This will match any request coming to this server
    server_name _;

    # 1. ADD THIS NEW LOCATION BLOCK
    # This location is specifically for the Fly.io health check.
    # It will respond with a 200 OK status, making the health check pass.
    location /healthz {
        # access_log off; # Optional: keeps health check pings out of your logs
        return 200 "ok";
        # Add a header to make it clear what this is for.
        add_header Content-Type text/plain;
    }

    # 2. MOVE YOUR REDIRECT INTO A 'location /' BLOCK
    # This block will now catch all other requests that are not '/healthz'.
    location / {
        # Using your correct new Firebase URL
        return 301 https://tactile-ripsaw-474418-j1.web.app$request_uri;
    }
}

